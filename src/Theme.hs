module Theme where

import XMonad.Hooks.DynamicLog (PP(..), xmobarColor, pad, xmobarPP)

import Data.List (intercalate)
import Flow


xftFont :: String
xftFont =
    [ "xft"
    , "Dina"
    , "size=8"
    , "antialias=true"
    , "autohint=0"
    , "hinting=true"
    , "hintstyle=hintfull"
    , "lcdfilter=lcddefault"
    , "rgba=rgb"
    ]
    |> intercalate ":"


-- {{{ COLORS

background :: String
background =
    "#1B1D1E"

black :: String
black =
    "#232526"

white :: String
white =
    "#F8F8F0"

red :: String
red =
    "#FF0000"

orange :: String
orange =
    "#FD971F"

magenta :: String
magenta =
    "#F92672"

cyan :: String
cyan =
    "#66D9EF"

green :: String
green =
    "#A6E22E"

-- }}}

-- {{{ PROMPT

promptForeground :: String
promptForeground =
    magenta

promptBackground :: String
promptBackground =
    background

promptBackgroundHighlight :: String
promptBackgroundHighlight =
    background

promptForegroundHighlight :: String
promptForegroundHighlight =
    green

promptBorderColor :: String
promptBorderColor =
    magenta

-- }}}

-- {{{ XMOBAR

focusedTitle :: String -> String
focusedTitle =
    xmobarColor black orange

unfocusedTitle :: String -> String
unfocusedTitle =
    xmobarColor orange background

currentWorkspace :: String -> String
currentWorkspace =
    xmobarColor black magenta

urgentWorkspace :: String -> String
urgentWorkspace =
    xmobarColor black cyan

statusSeparator :: String -> String
statusSeparator =
    xmobarColor green background

-- | An xmobar Pretty Printer for the Currently Focused Screen.
--
-- Drops the digit & underscore prefixes generated by `IndependentScreens`.
focusedScreenPP :: PP
focusedScreenPP = xmobarPP
    { ppTitle =
        focusedTitle . pad
    , ppVisible =
        const ""
    , ppCurrent =
        currentWorkspace . pad . dropPrefix
    , ppUrgent =
        urgentWorkspace . pad . dropPrefix
    , ppSep =
        statusSeparator <| pad "::"
    , ppWsSep =
        ""
    }
    where dropPrefix =
            dropWhile (/= '_') .> drop 1

-- | Similar to the `focusedScreenPP` but with a de-emphasized window title.
unfocusedScreenPP  :: PP
unfocusedScreenPP =
    focusedScreenPP { ppTitle = unfocusedTitle . pad }

-- }}}
